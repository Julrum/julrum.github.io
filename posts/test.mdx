---
title: 메모리 관리
description: 메모리 관리
date: "2021-03-20"
image: "/images/bridge.jpg"
---

# 메모리 관리

메모리 할당과 관리는 C++ 프로그래밍에서도 특히 문제가 발생하기 쉬운 부분이다.

## 동적 메모리 다루기

### 메모리의 작동 과정 살펴보기

메모리 한 칸을 레이블이 달린 상자로 표현한다. 여기서 레이블은 그 메모리를 사용하는 변수 이름에 해당한다. 그리고 상자에 담긴 데이터는 그 변수(메모리)에 현재 저장된 값이다.
이 코드는 함수 안에 있으므로 `i`는 로컬 변수다.

```c
int i = 7;
```

이러한 로컬 변수 `i`를 **자동 변수**(automatic variable)고 부르며 스택에 저장된다. 프로그램의 실행 흐름이 이 변수가 선언된 스코프를 벗어나면 할당된 메모리가 자동으로 해제된다.

| 스택 |     | 힙  |     |
| :--: | --- | :-: | --- |
| `i`  |     |  7  |     |

New 키워드를 사용하면 힙 메모리가 할당된다. 다음 코드는 `ptr` 변수를 스택에 생성하고 `nullptr`로 초기화한 뒤 `ptr`가 동적으로 생성된 힙 메모리를 가리키도록 설정한다.

```c
int* ptr = nullptr;
ptr = new int;
int* ptr = new int; // 한 줄 코드(one-liner)로 표현
```

여기서 `ptr` 변수는 여전히 스택에 있지만, 이 변수가 가리키는 값은 힙에 있다. 포인터 역시 일종의 변수이기 때문에 스택이나 힙에 존재한다. 반면 동적 메모리는 항상 힙에 할당된다.

| 스택  |                 | 힙  |        |
| ----- | --------------- | --- | ------ |
| `ptr` | _:arrow_right:_ | ?   | `*ptr` |

다음 코드는 포인터가 스택과 힙에 모두 있는 예를 보여준다.
